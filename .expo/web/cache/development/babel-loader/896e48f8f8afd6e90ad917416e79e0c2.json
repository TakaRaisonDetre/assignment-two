{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/taka_raison/Documents/react-native/rn-assignment/src/context/FirebaseContext.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { createContext } from 'react';\nimport firebase from 'firebase';\nimport \"firebase/auth\";\nimport \"firebase/firestore\";\nimport config from \"../config/firebase\";\nvar FirebaseContext = createContext();\n\nif (!firebase.apps.length) {\n  firebase.initializeApp(config);\n}\n\nvar db = firebase.firestore();\nvar Firebase = {\n  getCurrentUser: function getCurrentUser() {\n    return firebase.auth().currentUser;\n  },\n  createUser: function createUser(user) {\n    var uid, profilePhotoUrl;\n    return _regeneratorRuntime.async(function createUser$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(firebase.auth().createUserWithEmailAndPassword(user.email, user.password));\n\n          case 3:\n            uid = Firebase.getCurrentUser().uid;\n            profilePhotoUrl = \"default\";\n            _context.next = 7;\n            return _regeneratorRuntime.awrap(db.collection(\"users\").doc(uid).set({\n              username: user.username,\n              email: user.email,\n              profilePhotoUrl: profilePhotoUrl\n            }));\n\n          case 7:\n            if (!user.profilePhoto) {\n              _context.next = 11;\n              break;\n            }\n\n            _context.next = 10;\n            return _regeneratorRuntime.awrap(Firebase.uploadProfilePhoto(user.profilePhoto));\n\n          case 10:\n            profilePhotoUrl = _context.sent;\n\n          case 11:\n            delete user.password;\n            return _context.abrupt(\"return\", _objectSpread(_objectSpread({}, user), {}, {\n              profilePhotoUrl: profilePhotoUrl,\n              uid: uid\n            }));\n\n          case 15:\n            _context.prev = 15;\n            _context.t0 = _context[\"catch\"](0);\n            console.log(\"Error @ createUser:\", _context.t0.message);\n\n          case 18:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 15]], Promise);\n  },\n  getUserInfo: function getUserInfo(uid) {\n    var user;\n    return _regeneratorRuntime.async(function getUserInfo$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(db.collection(\"users\").doc(uid).get());\n\n          case 3:\n            user = _context2.sent;\n\n            if (!user.exists) {\n              _context2.next = 6;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", user.data());\n\n          case 6:\n            _context2.next = 11;\n            break;\n\n          case 8:\n            _context2.prev = 8;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.log(\"error @GetUserInfo\", _context2.t0);\n\n          case 11:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 8]], Promise);\n  },\n  logOut: function logOut() {\n    return _regeneratorRuntime.async(function logOut$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            _context3.next = 3;\n            return _regeneratorRuntime.awrap(firebase.auth().signOut());\n\n          case 3:\n            return _context3.abrupt(\"return\", true);\n\n          case 6:\n            _context3.prev = 6;\n            _context3.t0 = _context3[\"catch\"](0);\n            console.log(\"error @logout\", _context3.t0);\n\n          case 9:\n            return _context3.abrupt(\"return\", false);\n\n          case 10:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[0, 6]], Promise);\n  },\n  signIn: function signIn(email, password) {\n    return _regeneratorRuntime.async(function signIn$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            return _context4.abrupt(\"return\", firebase.auth().signInWithEmailAndPassword(email, password));\n\n          case 1:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n};\n\nvar FirebaseProvider = function FirebaseProvider(props) {\n  return React.createElement(FirebaseContext.Provider, {\n    value: Firebase,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 12\n    }\n  }, props.children);\n};\n\nexport { FirebaseContext, FirebaseProvider };","map":{"version":3,"sources":["/Users/taka_raison/Documents/react-native/rn-assignment/src/context/FirebaseContext.js"],"names":["React","createContext","firebase","config","FirebaseContext","apps","length","initializeApp","db","firestore","Firebase","getCurrentUser","auth","currentUser","createUser","user","createUserWithEmailAndPassword","email","password","uid","profilePhotoUrl","collection","doc","set","username","profilePhoto","uploadProfilePhoto","console","log","message","getUserInfo","get","exists","data","logOut","signOut","signIn","signInWithEmailAndPassword","FirebaseProvider","props","children"],"mappings":"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","sourcesContent":["import React, {createContext} from 'react'\n\nimport firebase from 'firebase'\n\nimport \"firebase/auth\"\nimport \"firebase/firestore\"\nimport config from '../config/firebase'\n\nconst FirebaseContext = createContext()\n\nif(!firebase.apps.length){\n  firebase.initializeApp(config)\n}\n\nvar db = firebase.firestore();\n\nconst Firebase ={\n\n getCurrentUser : ()=>{\n   return firebase.auth().currentUser\n },\n \n  createUser: async (user) =>{\n      try {\n       await firebase.auth().createUserWithEmailAndPassword(user.email, user.password)\n         const uid = Firebase.getCurrentUser().uid;\n\n         let profilePhotoUrl = \"default\";\n\n         await db.collection(\"users\").doc(uid).set({\n           username: user.username,\n           email: user.email,\n           profilePhotoUrl,\n         })\n\n         if(user.profilePhoto){\n              profilePhotoUrl = await Firebase.uploadProfilePhoto(user.profilePhoto)\n         }\n\n         delete user.password\n\n         return {...user, profilePhotoUrl, uid}\n\n      } catch(error) {\n        console.log(\"Error @ createUser:\", error.message)\n      }\n },\n\n getUserInfo : async (uid)=>{\n   try{\n     const user = await db.collection(\"users\").doc(uid).get()\n     if(user.exists){\n       return user.data()\n     }\n   } catch(error) {\n     console.log(\"error @GetUserInfo\", error)\n   }\n },\n\n logOut : async () =>{\n   try {\n      await firebase.auth().signOut()\n      return true;\n   }catch(error) {\n     console.log(\"error @logout\", error)\n   }\n   return false;\n },\n\n signIn : async (email, password)=>{\n   return firebase.auth().signInWithEmailAndPassword(email, password);\n  \n  \n}\n}\nconst FirebaseProvider = (props)=>{\n    return <FirebaseContext.Provider value={Firebase}>{props.children}</FirebaseContext.Provider>\n}\n\nexport {FirebaseContext, FirebaseProvider}"]},"metadata":{},"sourceType":"module"}